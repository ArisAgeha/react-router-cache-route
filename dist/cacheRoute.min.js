!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("prop-types"),require("react-router-dom")):"function"==typeof define&&define.amd?define(["exports","react","prop-types","react-router-dom"],t):t(e.CacheRoute={},e.React,e.PropTypes,e.reactRouterDom)}(this,function(e,t,r,d){"use strict";var f="default"in t?t.default:t;r=r&&r.hasOwnProperty("default")?r.default:r;var i=function(e){return void 0===e},m=function(e){return null===e},u=function(e){return"string"==typeof e},s=function(e){return!(i(e)||m(e))},v=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];t=u(t)?t.split("."):t;for(var n=void 0,o=e,c=0;c<t.length;c++){var a=t[c];if(!s(o))break;o=o[a]}return c===t.length&&(n=o),i(n)?r:n},l=function(e){for(var t=arguments.length,r=Array(2<t?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];o=u(o)?o.split("."):o;var c=v(e,o),a=v(e,o.slice(0,-1));return"function"==typeof c?c.call.apply(c,[a].concat(r)):c},h=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},y=function(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},_=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},b=16.3<=Number(v(l(f,"version.match",/^\d*\.\d*/),[0])),w=function(e,t){var r=e.match,n=e.when,o=void 0===n?"forward":n;if(v(r,"__CacheRoute__computedMatch__null")&&(r=null),!t.cached&&r)return{cached:!0,matched:!0};if(t.matched&&!r){var c=v(e,"history.action"),a=!1;switch(o){case"always":break;case"back":["PUSH","REPLACE"].includes(c)&&(a=!0);break;case"forward":default:"POP"===c&&(a=!0)}if(a)return{cached:!1,matched:!1}}return{matched:!!r}},O=function(e){function a(){var e,t,r;h(this,a);for(var n=arguments.length,o=Array(n),c=0;c<n;c++)o[c]=arguments[c];return(t=r=_(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(o)))).state=w(r.props,{cached:!1,matched:!1}),r.componentWillReceiveProps=b?void 0:function(e){r.setState(w(e,r.state))},r.cacheLifecycles={__listener:{},didCache:function(e){r.cacheLifecycles.__listener.didCache=e},didRecover:function(e){r.cacheLifecycles.__listener.didRecover=e}},_(r,t)}return o(a,e),n(a,[{key:"render",value:function(){var e=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return i(e)?l(t):l(e)},void 0)}(this.props.behavior(!this.state.matched),{}),t=e.className,r=void 0===t?"":t,n=y(e,["className"]),o=this.props.className,c=l((void 0===o?"":o)+" "+r,"trim"),a=""!==c;return this.state.cached?f.createElement("div",p({className:a?c:void 0},n),l(this.props,"children",this.cacheLifecycles)):null}},{key:"componentDidUpdate",value:function(e,t){if(t.cached&&this.state.cached)return!0===t.matched&&!1===this.state.matched?l(this,"cacheLifecycles.__listener.didCache"):!1===t.matched&&!0===this.state.matched?l(this,"cacheLifecycles.__listener.didRecover"):void 0}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.matched||t.matched}}]),a}(t.Component);O.propsTypes={history:r.object.isRequired,match:r.object.isRequired,children:r.func.isRequired,className:r.string,when:r.oneOf(["forward","back","always"]),behavior:r.func},O.defaultProps={when:"forward",behavior:function(e){return e?{style:{position:"absolute",zIndex:-9999,opacity:0,visibility:"hidden",pointerEvents:"none"}}:void 0}},O.getDerivedStateFromProps=b?w:void 0;var R=function(e){function a(){var e,t,r;h(this,a);for(var n=arguments.length,o=Array(n),c=0;c<n;c++)o[c]=arguments[c];return(t=r=_(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(o)))).render=function(){return r.props.render()},_(r,t)}return o(a,e),n(a,[{key:"shouldComponentUpdate",value:function(e){return s(e.match)&&!0!==v(e,"match.__CacheRoute__computedMatch__null")}}]),a}(t.Component);R.propsTypes={render:r.func.isRequired,match:r.object.isRequired};var c=function(e){function t(){return h(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),n(t,[{key:"render",value:function(){var e,t=this.props,r=t.children,n=t.render,o=t.component,c=t.className,a=t.when,i=t.behavior,u=y(t,["children","render","component","className","when","behavior"]);return(f.isValidElement(r)||(e=r,0!==f.Children.count(e)))&&(n=function(){return r}),f.createElement(d.Route,p({},u,{children:function(t){return f.createElement(O,p({},t,{when:a,className:c,behavior:i}),function(e){return f.createElement(R,{match:t.match,render:function(){return Object.assign(t,{cacheLifecycles:e}),o?f.createElement(o,t):l(n||r,void 0,t)}})})}}))}}]),t}(t.Component);c.componentName="CacheRoute",c.propTypes={component:r.func,render:r.func,children:r.oneOfType([r.func,r.node]),className:r.string,when:r.oneOf(["forward","back","always"]),behavior:r.func},c.defaultProps={when:"forward"};var a=function(e){function t(){return h(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),n(t,[{key:"render",value:function(){var l=this.context.router.route,e=this.props.children,h=this.props.location||l.location,p=!1;return f.Children.map(e,function(e){if(!f.isValidElement(e))return null;var t=e.props,r=t.path,n=t.exact,o=t.strict,c=t.sensitive,a=t.from,i=r||a,u=p?null:d.matchPath(h.pathname,{path:i,exact:n,strict:o,sensitive:c},l.match),s=void 0;switch(v(e,"type.componentName")){case"CacheRoute":s=f.cloneElement(e,{location:h,computedMatch:m(u)?{__CacheRoute__computedMatch__null:!0}:u});break;default:s=u&&!p?f.cloneElement(e,{location:h,computedMatch:u}):null}return p||(p=!!u),s})}}]),t}(d.Switch);a.contextTypes={router:r.shape({route:r.object.isRequired}).isRequired},a.propTypes={children:r.node,location:r.object},e.default=c,e.CacheRoute=c,e.CacheSwitch=a,Object.defineProperty(e,"__esModule",{value:!0})});
